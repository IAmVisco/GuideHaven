@using Microsoft.AspNetCore.Mvc.Localization
@using Microsoft.AspNetCore.Identity
@using GuideHaven.Areas.Identity.Data;
@inject IHtmlLocalizer<GuideLocalizer> Localizer
@inject UserManager<ApplicationUser> userManager

@{ int i = 0; }
@foreach (var item in Model)
{
    i++;
    <a href="~/Guide/Details/@item.GuideId" style="color: inherit; text-decoration: none;">
        <div class="guide-entry">
            <div class="guide-img-div">
                @if (item.Image == null)
                {
                    <img src="~/images/no-image.jpg" class="guide-img" />
                }
                else
                {
                    <img id="@item.GuideId" src="@item.Image" class="guide-img" />
                }
            </div>

            <div class="guide-inner">
                <h4 class="guide-header"><strong>@item.GuideName</strong></h4>
                <span class="guide-author">
                    <strong>
                        @Localizer["by"]
                        @{ApplicationUser owner = await userManager.FindByIdAsync(item.Owner);}
                        @if (owner != null)
                        {
                            @owner.UserName
                        }
                        else
                        {
                            @Localizer["DeletedUser"]
                        }
                    </strong>
                </span>
                @if (item.Ratings != null)
                {
                    <fieldset class="rating-index">
                        <input type="radio" id="star5-@i-@ViewData["mode"]" name="rating-@i-@ViewData["mode"]" value="5" disabled />
                        <label class="full" for="star5-@i-@ViewData["mode"]"></label>
                        <input type="radio" id="star4-@i-@ViewData["mode"]" name="rating-@i-@ViewData["mode"]" value="4" disabled />
                        <label class="full" for="star4-@i-@ViewData["mode"]"></label>
                        <input type="radio" id="star3-@i-@ViewData["mode"]" name="rating-@i-@ViewData["mode"]" value="3" disabled />
                        <label class="full" for="star3-@i-@ViewData["mode"]"></label>
                        <input type="radio" id="star2-@i-@ViewData["mode"]" name="rating-@i-@ViewData["mode"]" value="2" disabled />
                        <label class="full" for="star2-@i-@ViewData["mode"]"></label>
                        <input type="radio" id="star1-@i-@ViewData["mode"]" name="rating-@i-@ViewData["mode"]" value="1" disabled />
                        <label class="full" for="star1-@i-@ViewData["mode"]"></label>
                    </fieldset>
                    <script>
                        setTimeout(function () {
                            var x = "#star" + Math.round(@item.GetRating()) + "-@i-@ViewData["mode"]";
                            $(x).prop("checked", true);
                        }, 500);
                    </script>
                }
                else
                {
                    <span>@Localizer["NoRatingsYet"]</span>
                }
                <span class="guide-views guide-info" title="@item.Views  @Localizer["Views"]"><i class="icon-eye-open"></i>  @item.Views</span>
                <span class="guide-date guide-info" title="@Localizer["Created"]: @item.CreationDate.ToString("HH:mm:ss dd.MM.yyyy")"><i class="icon-calendar"></i>  @item.CreationDate.ToString("dd.MM.yyyy")</span>
                <p>@item.Description</p>
            </div>
        </div>
    </a>
}